<!DOCTYPE html>

<html>

<head>
  <!-- jQuery -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>


  <script src='https://hnyc2017.ddns.net:56582/tree.js'></script>
  <script src='https://hnyc2017.ddns.net:56582/shaders_factory.js'></script>
  <script src='https://hnyc2017.ddns.net:56582/twinkles.js'></script>

  <script>
    var gl = null;
    var tree = null;
    var eyeAzimuth = 0.0;
    var eyeAzimuthInc = 0.01;

    function display() {
      gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
      tree.draw(gl, eyeAzimuth, 500, 500);
      eyeAzimuth += eyeAzimuthInc;
      if (eyeAzimuth >= 2 * Math.PI) {
        eyeAzimuth = 0.0;
      }
    }

    $(document).ready(function() {
      var canvas = document.getElementById('glCanvas');
      canvas.width = 500;
      canvas.height = 500;

      if (window.WebGLRenderingContext) {
        gl = canvas.getContext('webgl');
      }
      if (!gl) {
        alert('WebGL initialization failed');
      }

      gl.clearColor(0.76, 0.69, 0.47, 1.0);
      gl.enable(gl.DEPTH_TEST);
      gl.enable(gl.BLEND);
      gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);

      tree = new Tree(gl);

      var interval = setInterval(display, 30);
      $(window).focus(function() {
        interval = setInterval(display, 30);
      });
      $(window).blur(function() {
        clearInterval(interval);
      });

    });
  </script>
</head>

<body>
  <canvas id="glCanvas"></canvas>
</body>

</html>
